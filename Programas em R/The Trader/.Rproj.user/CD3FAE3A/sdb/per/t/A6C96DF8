{
    "collab_server" : "",
    "contents" : "RequestClass = R6Class(\"RequestClass\",\n                       \n                       public = list(\n                         \n                         #=================================================#\n                         getValues.now = function(keys){\n                           \n                           keys_string = paste0(keys, collapse = \"','\")\n                           \n                           base = \"https://query.yahooapis.com/v1/public/yql?\"\n                           query = sprintf(\"q=select symbol,Name,Currency,Bid,Ask,LastTradePriceOnly from yahoo.finance.quotes where symbol in ('%s')&\",keys_string)\n                           format = \"format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=\"\n                           \n                           yql = paste0(base, query, format)\n                           \n                           action.table = private$getTable(yql)\n                           \n                           order.name = c(\"symbol\",\"Name\",\"Currency\",\"Bid\",\"Ask\",\"LastTradePriceOnly\",\"queryDateTime\")\n                           action.table = action.table[,order.name, with = F]\n                           action.table$type = \"observed\"\n                           \n                           return(action.table)\n                         },\n                         #=================================================#\n                         \n                         #=================================================#\n                         getValues.historical = function(keys, dataInicio, dataFim){\n                           \n                           dataInicio = as.character(dataInicio)\n                           dataFim = as.character(dataFim)\n                           \n                           keys_string = paste0(keys, collapse = \"','\")\n                           \n                           base = \"https://query.yahooapis.com/v1/public/yql?\"\n                           query = sprintf(\"q=select * from yahoo.finance.historicaldata where symbol in ('%s') and startDate = '%s' and endDate = '%s'&\",keys_string ,dataInicio, dataFim)\n                           format = \"format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=\"\n                           \n                           yql = paste0(base, query, format)\n                           \n                           historical.table = private$getTable(yql)\n                           historical.table$type = \"observed\"\n                           \n                           return(historical.table)\n                         }\n                         #==================================================#\n                       ),\n                       \n                       private = list(\n                         \n                         #=================================================#\n                         getTable = function(yql, queryDateTime = T){\n                           \n                           yql = gsub(\" \",\"%20\",yql)\n                           \n                           jsonResp = fromJSON(yql)\n                           \n                           table = jsonResp$query$results$quote\n                           table = as.data.table(table)\n                           \n                           if(queryDateTime){\n                             \n                             queryDateTime = jsonResp$query$created\n                             queryDateTime = gsub(\"Z\", \"\", queryDateTime)\n                             queryDateTime = gsub(\"T\", \" \", queryDateTime)\n                             \n                             table$queryDateTime = queryDateTime\n                           }\n                           \n                           return(table)\n                         }\n                         #=================================================#\n                       )\n)",
    "created" : 1479127190092.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2120904649",
    "id" : "A6C96DF8",
    "lastKnownWriteTime" : 1479135122,
    "last_content_update" : 1479135122,
    "path" : "~/Dropbox/The Trader/src/RequestClass.R",
    "project_path" : "src/RequestClass.R",
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}