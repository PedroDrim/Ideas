{
    "contents" : "\n# This is the server logic for a Shiny web application.\n# You can find out more about building applications with Shiny here:\n#\n# http://shiny.rstudio.com\n#\n\nlibrary(shiny)\nsource(\"src//startFunction.R\")\n\nshinyServer(function(input, output, session) {\n     \n     load.datas()\n     contador = 1\n     \n     set_data = function(contador){\n          \n          requestObject = RequestClass$new()\n          keys = c(\"YHOO\",\"AAPL\",\"GOOG\",\"MSFT\")\n          arquivo = \"dados.csv\"\n          \n          exist = file.exists(arquivo)\n          \n          values = requestObject$getValues.now(keys, contador)\n          write.table(values, arquivo, append = exist, row.names = F, col.names = !exist)\n     }\n     \n     output$dygraph <- renderDygraph({\n          \n          invalidateLater(1000, session)\n          set_data(contador)\n          contador = contador + 1\n          \n          tabela.ini = fread(\"dados.csv\")\n          \n          keys = input$keysGroup\n          coln = input$colNames\n          rangemax = input$rangeMax\n          \n          if(length(keys) > 0){\n               \n               x = c()\n               \n               for(key in keys){\n                    \n                    index = which(tabela.ini$symbol == key)\n                    tabela = tabela.ini[index]\n                    \n                    tamanho = dim(tabela)[1]\n                    inicio = 1\n                    if(tamanho > rangemax){\n                         inicio = tamanho - rangemax\n                    }\n                    tabela = tabela[inicio:tamanho]\n                    \n                    valores = tabela[,coln, with = F]\n                    valores = unlist(valores)\n                    valores = as.numeric(valores)\n                    \n                    valor.maximo = max(valores)\n                    valor.minimo = min(valores)\n                    \n                    if(valor.maximo > valor.minimo * 100){\n                         valor.media = mean(valores[valores != valor.maximo])\n                         valores[valores == valor.maximo] = valor.media\n                    }\n                    \n                    dateTime = strptime(tabela$queryDateTime, \"%Y-%m-%d %H:%M:%S\")\n                    dateTime = as.numeric(dateTime)\n                    dtTs = ts(valores, min(dateTime), max(dateTime))\n                    \n                    x = cbind(dtTs,x)\n                    \n               }\n          }else{\n               x = ts()\n          }\n          \n          grafico = dygraph(x, main = \"Quadro de acoes\", ylab = \"Valor\", xlab = \"horario\")\n     })\n     \n})\n",
    "created" : 1478881029039.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1342982025",
    "id" : "AA652E54",
    "lastKnownWriteTime" : 1478883300,
    "path" : "C:/Users/pedro.farias/Desktop/The Actionist/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_source"
}